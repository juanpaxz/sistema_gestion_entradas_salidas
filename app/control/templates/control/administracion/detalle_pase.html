{% extends 'control/base.html' %}
{% load static %}

{% block content %}
<div class="container py-4">
    <div class="row mb-4">
        <div class="col-md-8">
            <h2>
                <i class="fas fa-file-alt"></i> Detalles del Pase - {{ pase.folio }}
            </h2>
        </div>
        <div class="col-md-4 text-end">
            <a href="{% url 'control:listar_pases' %}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Volver
            </a>
        </div>
    </div>

    <div class="row">
        <div class="col-md-8">
            <div class="card mb-4">
                <div class="card-header bg-light">
                    <h5 class="mb-0">Informaci칩n del Pase</h5>
                </div>
                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <strong>Folio:</strong>
                            <p>{{ pase.folio }}</p>
                        </div>
                        <div class="col-md-6">
                            <strong>Tipo:</strong>
                            <p>
                                {% if pase.tipo == 'entrada' %}
                                    <span class="badge bg-info">Pase de Entrada</span>
                                {% else %}
                                    <span class="badge bg-warning">Pase de Salida</span>
                                {% endif %}
                            </p>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <strong>Empleado:</strong>
                            <p>{{ pase.empleado.nombre }} {{ pase.empleado.apellido }}</p>
                        </div>
                        <div class="col-md-6">
                            <strong>Puesto:</strong>
                            <p>{{ pase.empleado.puesto }}</p>
                        </div>
                    </div>

                    <hr>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <strong>Fecha:</strong>
                            <p>{{ pase.fecha|date:"d \d\e F \d\e Y"|capfirst }}</p>
                        </div>
                        <div class="col-md-6">
                            <strong>Hora de Entrada/Salida:</strong>
                            <p>{{ pase.hora|time:"H:i" }}</p>
                        </div>
                    </div>

                    {% if pase.hora_reincorporacion %}
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <strong>Hora de Reincorporaci칩n:</strong>
                                <p>{{ pase.hora_reincorporacion|time:"H:i" }}</p>
                            </div>
                        </div>
                    {% endif %}

                    <hr>

                    <div class="mb-3">
                        <strong>Asunto:</strong>
                        <p>{{ pase.asunto }}</p>
                    </div>

                    <div class="mb-3">
                        <strong>Observaciones:</strong>
                        <p>{{ pase.observaciones|default:"Sin observaciones" }}</p>
                    </div>

                    <hr>

                    <div class="row">
                        <div class="col-md-6">
                            <strong>Creado por:</strong>
                            <p>{{ pase.creado_por.get_full_name }}</p>
                        </div>
                        <div class="col-md-6">
                            <strong>Fecha de Creaci칩n:</strong>
                            <p>{{ pase.fecha_creacion|date:"d/m/Y H:i" }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card">
                <div class="card-header bg-light">
                    <h5 class="mb-0">Acciones</h5>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        {% if pase.pdf_generado %}
                            <a href="{% url 'control:descargar_pase_pdf' pase.id %}" class="btn btn-success" download>
                                <i class="fas fa-download"></i> Descargar PDF
                            </a>
                            <a href="{{ pase.pdf_generado.url }}" class="btn btn-info" target="_blank">
                                <i class="fas fa-eye"></i> Ver PDF
                            </a>
                        {% else %}
                            <button class="btn btn-secondary" disabled>
                                <i class="fas fa-exclamation"></i> PDF No Disponible
                            </button>
                        {% endif %}
                        
                        <a href="{% url 'control:editar_pase' pase.id %}" class="btn btn-warning">
                            <i class="fas fa-edit"></i> Editar
                        </a>
                        
                        <a href="{% url 'control:eliminar_pase' pase.id %}" class="btn btn-danger">
                            <i class="fas fa-trash"></i> Eliminar
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Preview del PDF si est치 disponible -->
    {% if pase.pdf_generado %}
        <div class="card mt-4">
            <div class="card-header bg-light">
                <h5 class="mb-0">Vista Previa del PDF</h5>
            </div>
            <div class="card-body">
                <iframe src="{{ pase.pdf_generado.url }}" style="width: 100%; height: 600px; border: 1px solid #ddd;"></iframe>
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}
